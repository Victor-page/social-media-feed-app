(this["webpackJsonpredux-essentials-example"]=this["webpackJsonpredux-essentials-example"]||[]).push([[0],{1312:function(t,e){},1314:function(t,e,n){"use strict";n.r(e);var r=n(26),s=n(8),a=n.n(s),c=n(3),o=n.n(c),i=n(70),u=n.n(i),d=n(13),j=(n(141),n(30)),p=n(12),l=n(4),b=function(){return Object(l.jsx)("nav",{children:Object(l.jsx)("section",{children:Object(l.jsxs)("div",{className:"navContent",children:[Object(l.jsx)("div",{className:"navLinks"}),Object(l.jsx)(j.b,{to:"/",children:"Posts"})]})})})},f=n(11),O=n(17),h=n(15),m=n(78),x=["body"];function v(t){return g.apply(this,arguments)}function g(){return g=Object(r.a)(a.a.mark((function t(e){var n,r,s,c,o,i,u,d=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:{},r=n.body,s=Object(m.a)(n,x),c={"Content-Type":"application/json"},o=Object(h.a)(Object(h.a)({method:r?"POST":"GET"},s),{},{headers:Object(h.a)(Object(h.a)({},c),s.headers)}),r&&(o.body=JSON.stringify(r)),t.prev=4,t.next=7,window.fetch(e,o);case 7:return u=t.sent,t.next=10,u.json();case 10:if(i=t.sent,!u.ok){t.next=13;break}return t.abrupt("return",{status:u.status,data:i,headers:u.headers,url:u.url});case 13:throw new Error(u.statusText);case 16:return t.prev=16,t.t0=t.catch(4),t.abrupt("return",Promise.reject(t.t0.message?t.t0.message:i));case 19:case"end":return t.stop()}}),t,null,[[4,16]])}))),g.apply(this,arguments)}v.get=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v(t,Object(h.a)(Object(h.a)({},e),{},{method:"GET"}))},v.post=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return v(t,Object(h.a)(Object(h.a)({},n),{},{body:e}))};var y=Object(O.b)("posts/fetchPosts",Object(r.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.get("fakeApi/posts");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})))),S=Object(O.b)("postst/addNewPost",function(){var t=Object(r.a)(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.post("/fakeApi/posts",e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),w=Object(O.c)({name:"posts",initialState:{postList:[],status:"idle",error:null},reducers:{postUpdated:function(t,e){var n=e.payload,r=n.id,s=n.title,a=n.content,c=t.postList.find((function(t){return t.id===r}));c&&(c.title=s,c.content=a)},reactionAdded:function(t,e){var n=e.payload,r=n.postId,s=n.reaction,a=t.postList.find((function(t){return t.id===r}));a&&a.reactions[s]++}},extraReducers:function(t){t.addCase(y.pending,(function(t,e){t.status="loading"})).addCase(y.fulfilled,(function(t,e){t.status="succeeded",t.postList=t.postList.concat(e.payload)})).addCase(y.rejected,(function(t,e){t.status="failed",t.error=e.error.message})),t.addCase(S.fulfilled,(function(t,e){t.postList.push(e.payload)}))}}),N=w.reducer,k=w.actions,I=k.postAdded,A=k.postUpdated,C=k.reactionAdded,P=N,T=function(t){return t.posts.postList},F=function(t,e){return t.posts.postList.find((function(t){return t.id===e}))},L=function(){var t=Object(c.useState)(""),e=Object(f.a)(t,2),n=e[0],r=e[1],s=Object(c.useState)(""),a=Object(f.a)(s,2),o=a[0],i=a[1],u=Object(c.useState)(""),j=Object(f.a)(u,2),p=j[0],b=j[1],O=Object(d.b)(),h=Object(d.c)((function(t){return t.users})),m=Boolean(n)&&Boolean(o)&&Boolean(p),x=h.map((function(t){var e=t.id,n=t.name;return Object(l.jsx)("option",{value:e,children:n},e)}));return Object(l.jsxs)("section",{children:[Object(l.jsx)("h2",{children:"Add a New Post"}),Object(l.jsxs)("form",{onSubmit:function(t){t.preventDefault(),n&&o&&O(I(n,o,p)),r(""),i("")},children:[Object(l.jsx)("label",{htmlFor:"postTitle",children:"Post Title:"}),Object(l.jsx)("input",{type:"text",id:"postTitle",name:"postTitle",value:n,onChange:function(t){var e=t.target;return r(e.value)}}),Object(l.jsx)("label",{htmlFor:"postAuthor",children:"Author:"}),Object(l.jsxs)("select",{id:"postAuthor",value:p,onChange:function(t){var e=t.target;return b(e.value)},children:[Object(l.jsx)("option",{value:""}),x]}),Object(l.jsx)("label",{htmlFor:"postContent",children:"Post:"}),Object(l.jsx)("textarea",{type:"text",id:"postContent",name:"postContent",value:o,onChange:function(t){var e=t.target;return i(e.value)}}),Object(l.jsx)("button",{type:"submit",disabled:!m,children:"Save Post"})]})]})},q=function(t){var e=t.userId,n=Object(d.c)((function(t){return t.users.find((function(t){return t.id===e}))}));return Object(l.jsxs)("span",{children:["by ",n?n.name:"Unknown author"]})},D={thumbsUp:"\ud83d\udc4d",hooray:"\ud83c\udf89",heart:"\u2764\ufe0f",rocket:"\ud83d\ude80",eyes:"\ud83d\udc40"},E=function(t){var e=t.post,n=Object(d.b)(),r=function(t,e){return n(C({postId:t,reaction:e}))},s=Object.entries(D).map((function(t){var n=Object(f.a)(t,2),s=n[0],a=n[1];return Object(l.jsxs)("button",{type:"button",className:"muted-button reaction-button",onClick:r.bind(null,e.id,s),children:[a," ",e.reactions[s]]},s)}));return Object(l.jsx)("div",{children:s})},U=n(100),M=n(101),J=function(t){var e=t.timestamp,n="";if(e){var r=Object(U.a)(e),s=Object(M.a)(r);n="".concat(s," ago")}return Object(l.jsxs)("span",{title:e,children:["\xa0 ",Object(l.jsx)("i",{children:n})]})},B=function(t){var e=t.text,n=void 0===e?"":e,r=t.size,s=void 0===r?"5em":r,a=n?Object(l.jsx)("h4",{children:n}):null;return Object(l.jsxs)("div",{className:"spinner",children:[a,Object(l.jsx)("div",{className:"loader",style:{height:s,width:s}})]})},K=function(t){var e=t.post;return Object(l.jsxs)("article",{children:[Object(l.jsx)("h3",{children:e.title}),Object(l.jsxs)("div",{children:[Object(l.jsx)(q,{userId:e.user}),Object(l.jsx)(J,{timestamp:e.date})]}),Object(l.jsx)("p",{className:"post-content",children:e.content.substring(0,100)}),Object(l.jsx)(E,{post:e}),Object(l.jsx)(j.b,{to:"/posts/".concat(e.id),className:"button muted-button",children:"View Post"})]})},R=function(){var t,e=Object(d.b)(),n=Object(d.c)(T),r=Object(d.c)((function(t){return t.posts.status})),s=Object(d.c)((function(t){return t.posts.error}));if(Object(c.useEffect)((function(){"idle"===r&&e(y())}),[e,r]),"loading"===r)t=Object(l.jsx)(B,{text:"Loading..."});else if("succeeded"===r){t=n.slice().sort((function(t,e){return e.date.localeCompare(t.date)})).map((function(t){return Object(l.jsx)(K,{post:t},t.id)}))}else"failed"===r&&(t=Object(l.jsx)("p",{children:s}));return Object(l.jsxs)("section",{className:"post-list",children:[Object(l.jsx)("h2",{children:"Posts"}),t]})},G=function(t){var e=t.match.params.postId,n=Object(d.c)((function(t){return F(t,e)})),r=n.user,s=n.id,a=n.title,c=n.content,o=n.date;return n?Object(l.jsx)("section",{children:Object(l.jsxs)("article",{className:"post",children:[Object(l.jsx)("h2",{children:a}),Object(l.jsxs)("div",{children:[Object(l.jsx)(q,{userId:r}),Object(l.jsx)(J,{timestamp:o})]}),Object(l.jsx)("p",{className:"post-content",children:c}),Object(l.jsx)(E,{post:n}),Object(l.jsx)(j.b,{to:"/edit-post/".concat(s),className:"button",children:"Edit Post"})]})}):Object(l.jsx)("section",{children:Object(l.jsx)("h2",{children:"Post not found!"})})},W=function(t){var e=t.match.params.postId,n=Object(d.c)((function(t){return F(t,e)})),r=Object(c.useState)(n.title),s=Object(f.a)(r,2),a=s[0],o=s[1],i=Object(c.useState)(n.content),u=Object(f.a)(i,2),j=u[0],b=u[1],O=Object(d.b)(),h=Object(p.g)();return Object(l.jsxs)("section",{children:[Object(l.jsx)("h2",{children:"Edit Post"}),Object(l.jsxs)("form",{onSubmit:function(t){t.preventDefault(),a&&j&&(O(A({id:e,content:j,title:a})),h.push("/posts/".concat(e)))},children:[Object(l.jsx)("label",{htmlFor:"postTitle",children:"Post Title:"}),Object(l.jsx)("input",{type:"text",id:"postTitle",name:"postTitle",placeholder:"What's on your mind?",value:a,onChange:function(t){return o(t.target.value)}}),Object(l.jsx)("label",{htmlFor:"postContent",children:"Content:"}),Object(l.jsx)("textarea",{id:"postContent",name:"postContent",value:j,onChange:function(t){return b(t.target.value)}}),Object(l.jsx)("button",{type:"submit",children:"Save Post"})]})]})};var z,V=function(){return Object(l.jsxs)(j.a,{children:[Object(l.jsx)(b,{}),Object(l.jsx)("div",{className:"App",children:Object(l.jsxs)(p.d,{children:[Object(l.jsx)(p.b,{exact:!0,path:"/",render:function(){return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(L,{}),Object(l.jsx)(R,{})]})}}),Object(l.jsx)(p.b,{exact:!0,path:"/posts/:postId",component:G}),Object(l.jsx)(p.b,{exact:!0,path:"/edit-post/:postId",component:W}),Object(l.jsx)(p.a,{to:"/"})]})})]})},H=Object(O.b)("users/fetchUsers",Object(r.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.get("/fakeApi/users");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})))),Q=Object(O.c)({name:"users",initialState:[],reducers:{},extraReducers:function(t){t.addCase(H.fulfilled,(function(t,e){return e.payload}))}}).reducer,X=Object(O.a)({reducer:{posts:P,users:Q}}),Y=n(37),Z=n(49),$=n(28),_=n(75),tt=n(23),et=n(32),nt=n.n(et),rt=n(99),st=n.n(rt),at=n(131),ct=n(132),ot=["id"],it=2e3,ut=st()(),dt=localStorage.getItem("randomTimestampSeed");function jt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(ut()*(e-t+1))+t}dt?z=new Date(dt):(dt=(z=new Date).toISOString(),localStorage.setItem("randomTimestampSeed",dt)),ut=st()(dt),Object(ct.setRandom)(ut),nt.a.seed(z.getTime());for(var pt,lt=function(t){return t[jt(0,t.length-1)]},bt=Object(tt.factory)({user:{id:Object(tt.primaryKey)(O.d),firstName:String,lastName:String,name:String,username:String,posts:Object(tt.manyOf)("post")},post:{id:Object(tt.primaryKey)(O.d),title:String,date:String,content:String,reactions:Object(tt.oneOf)("reaction"),comments:Object(tt.manyOf)("comment"),user:Object(tt.oneOf)("user")},comment:{id:Object(tt.primaryKey)(String),date:String,text:String,post:Object(tt.oneOf)("post")},reaction:{id:Object(tt.primaryKey)(O.d),thumbsUp:Number,hooray:Number,heart:Number,rocket:Number,eyes:Number,post:Object(tt.oneOf)("post")}}),ft=function(){var t=nt.a.name.firstName(),e=nt.a.name.lastName();return{firstName:t,lastName:e,name:"".concat(t," ").concat(e),username:nt.a.internet.userName()}},Ot=0;Ot<3;Ot++)for(var ht=bt.user.create(ft()),mt=0;mt<3;mt++){var xt=(pt=ht,{title:nt.a.lorem.words(),date:nt.a.date.recent(7).toISOString(),user:pt,content:nt.a.lorem.paragraphs(),reactions:bt.reaction.create()});bt.post.create(xt)}var vt=function(t){return Object(h.a)(Object(h.a)({},t),{},{user:t.user.id})},gt=[$.e.get("/fakeApi/posts",(function(t,e,n){var r=bt.post.getAll().map(vt);return e(n.delay(it),n.json(r))})),$.e.post("/fakeApi/posts",(function(t,e,n){var r=t.body;if("error"===r.content)return e(n.delay(it),n.status(500),n.json("Server error saving this post!"));r.date=(new Date).toISOString();var s=bt.user.findFirst({where:{id:{equals:r.user}}});r.user=s,r.reactions=bt.reaction.create();var a=bt.post.create(r);return e(n.delay(it),n.json(vt(a)))})),$.e.get("/fakeApi/posts/:postId",(function(t,e,n){var r=bt.post.findFirst({where:{id:{equals:t.params.postId}}});return e(n.delay(it),n.json(vt(r)))})),$.e.patch("/fakeApi/posts/:postId",(function(t,e,n){var r=t.body,s=(r.id,Object(m.a)(r,ot)),a=bt.post.update({where:{id:{equals:t.params.postId}},data:s});return e(n.delay(it),n.json(vt(a)))})),$.e.get("/fakeApi/posts/:postId/comments",(function(t,e,n){var r=bt.post.findFirst({where:{id:{equals:t.params.postId}}});return e(n.delay(it),n.json({comments:r.comments}))})),$.e.post("/fakeApi/posts/:postId/reactions",(function(t,e,n){var r=t.params.postId,s=t.body.reaction,a=bt.post.findFirst({where:{id:{equals:r}}}),c=bt.post.update({where:{id:{equals:r}},data:{reactions:Object(h.a)(Object(h.a)({},a.reactions),{},Object(Z.a)({},s,a.reactions[s]+=1))}});return e(n.delay(it),n.json(vt(c)))})),$.e.get("/fakeApi/notifications",(function(t,e,n){var r=kt(void 0,jt(1,5),bt);return e(n.delay(it),n.json(r))})),$.e.get("/fakeApi/users",(function(t,e,n){return e(n.delay(it),n.json(bt.user.getAll()))}))],yt=_.setupWorker.apply(void 0,gt),St=new at.Server("ws://localhost"),wt=function(t,e){!function(t,e){t.send(JSON.stringify(e))}(t,{type:"notifications",payload:kt(e,jt(1,5),bt)})};St.on("connection",(function(t){t,t.on("message",(function(e){var n=JSON.parse(e);if("notifications"===n.type){var r=n.payload;wt(t,r)}}))}));var Nt=["poked you","says hi!","is glad we're friends","sent you a gift"];function kt(t,e,n){var r,s=new Date;t?r=Object(U.a)(t):(r=new Date(s.valueOf())).setMinutes(r.getMinutes()-15);var a=Object(Y.a)(Array(e)).map((function(){var t=lt(n.user.getAll()),e=lt(Nt);return{id:Object(O.d)(),date:nt.a.date.between(r,s).toISOString(),message:e,user:t.id}}));return a}function It(){return(It=Object(r.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yt.start({onUnhandledRequest:"bypass"});case 2:X.dispatch(H()),u.a.render(Object(l.jsx)(o.a.StrictMode,{children:Object(l.jsx)(d.a,{store:X,children:Object(l.jsx)(V,{})})}),document.getElementById("root"));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){It.apply(this,arguments)}()},141:function(t,e,n){}},[[1314,1,2]]]);
//# sourceMappingURL=main.05d7dd4f.chunk.js.map